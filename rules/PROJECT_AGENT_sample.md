# PROJECT_AGENT.md - loganalyzer プロジェクトエージェント（サンプル）

**作成日**: 2025-12-11  
**プロジェクト名**: loganalyzer  
**目的**: ログデータの可視化・分析に特化したプロジェクト  
※このファイルは「例＋記入ガイド」です。自分のプロジェクトに合わせて書き換えてください。

---

## 1. プロジェクト概要

> ガイド: ここでは「このプロジェクトは何者か？」を、初めて読む人にも伝わるようにまとめます。

### 1.1 プロジェクト名

> ガイド: リポジトリ名やサービス名など、チーム内で共有されている正式名称を書きます。

- **loganalyzer**

### 1.2 目的

> ガイド: 「このプロジェクトで何を実現したいか」を 1〜3 行で書きます。  
> 例: ログ収集／分析、テスト自動化、スクレイピング基盤など。

- ログデータの可視化・分析に特化したプロジェクト

### 1.3 主要機能

> ガイド: このプロジェクトが提供する主な機能を箇条書きにします。  
> 「現状」と「今後追加したいもの」が混ざる場合はコメントで区別しても構いません。

- リモートデバイスからのログ取得
- ログ分析
- ログ可視化
- ロールバック

### 1.4 使用言語・プラットフォーム

> ガイド: 実装の中心となる言語と、想定している実行環境を書きます。  
> 例: Python 3.11 / Node.js 22 / Go 1.23 など、バージョンも書いておくと親切です。

- **使用言語**: Bash (シェルスクリプト), Python 3
- **プラットフォーム**: macOS (Darwin), Linux

---

## 2. プロジェクト固有の注意事項

> ガイド: GLOBAL_AGENT.md の共通ルールに「このプロジェクトだけの前提・地雷」を足す場所です。  
> 実行環境の制約や、「ここを触ると事故る」領域をはっきり書いておきます。

### 2.1 実行環境

> ガイド: 想定している OS / バージョン / 依存ツールなどを書きます。  
> 例: 「Windows は非サポート」「Docker 前提」「Python 3.10 固定」など。

- **プラットフォーム**: macOS (Darwin), Linux  
- Windows 環境は動作保証しない（必要な場合は個別に検証する）

### 2.2 Chrome DevTools MCP 使用時の重要ルール

> ガイド: loganalyzer ではブラウザ自動操作も関わるため、危険な操作をここで明示的に禁止します。  
> 他プロジェクトでは、ここに「この MCP は原則使わない」などを書いてもよいです。

- **`take_snapshot` の使用を全面禁止**  
  - 理由: 大量 DOM 出力により LLM のコンテキストを圧迫し、システム停止の原因になるため
- 代替手段（必須）:
  - 視覚確認: `take_screenshot`
  - データ取得: `evaluate_script` でサンプリング・統計を取得
- 10,000件以上のデータをデバッグする際は、必ず段階的アプローチを採用する  
- 詳細は `rules_domain.md` の「Chrome DevTools MCP 使用ガイド」を参照

---

## 3. ログ処理の基本方針

> ガイド: データの扱い方を「このプロジェクト視点」で補足します。  
> 共通の原則（完全性・冪等性など）は GLOBAL_AGENT.md に書いてあるので、ここでは特に重要なものだけを強調します。

**注意**: データ処理の基本原則（データの完全性、時間精度、冪等性、エラーハンドリング、ドキュメント同期）については、  
`../common/GLOBAL_AGENT.md` の「2.2 作業の進め方 > データ処理の基本原則」を参照してください。

### 3.1 ログファイル配置の統一（必須遵守）

> ガイド: 「ログはどこに置くか？」を厳密に決めておきます。  
> ここに書いたルールを破ると、後で解析ツールやビューが壊れると想定してください。

- **【重要】ログ出力場所**: すべてのログファイルは **必ず** プロジェクトルートの `logs/` ディレクトリに保存すること
  - 他のディレクトリ（`procedures/logs/`、`./logs` など）への出力は禁止
  - スクリプト内で出力ディレクトリを指定する場合は、必ずプロジェクトルートの `logs/` を指すように設定する
  - デフォルト出力ディレクトリの例: `${SCRIPT_DIR}/../../logs` または `./logs`（プロジェクトルートからの相対パス）

- **ディレクトリ命名規則**: `${HOSTNAME}_${TIMESTAMP}` 形式（例: `192.168.1.17_20251209_103532`）
  - `HOSTNAME`: リモートホストの IP アドレスまたはホスト名（`:` は `_` に変換）
  - `TIMESTAMP`: 取得日時（`YYYYMMDD_HHMMSS` 形式、JST）

- 詳細な運用ルールは `logs/README.md` を参照すること

### 3.2 ログ取得・処理の基本ツール

> ガイド: 「どのスクリプトを入口に使うべきか」をここに固定します。  
> ツールが増えたら、ここを最新に保つことで迷子を減らします。

- **基本ツール**: `procedures/tools/get_data.sh` と `procedures/tools/split_log_file.py` を利用するのが基本
- `get_data.sh`: ログ取得・マージ・タイムスタンプ調整を一括実行
- `split_log_file.py`: ログファイルの分割・時刻範囲フィルタリング
- これらのツールを組み合わせて使用することを推奨
- 詳細な使用方法は各スクリプトのヘルプまたは `logs/README.md` を参照

---

## 4. プロジェクト固有の禁止事項

> ガイド: GLOBAL_AGENT.md の禁止事項に「このプロジェクトだけの NG」を追加する場所です。  
> 「一度やらかしたこと」や「やると死ぬ操作」を優先的に書いておきます。

- ❌ **ログファイルを `logs/` 以外のディレクトリに出力すること（必須遵守）**
- ❌ **`mcp__Chrome-DevTools-MCP__take_snapshot` の使用（システム停止の原因）**

※禁止理由を簡単にコメントしておくと、後から読んだ人や AI が判断しやすくなります。

---

## 5. 共通ルールへの参照

> ガイド: 「このプロジェクトはどの共通ルールに従うか」をリンクしておく場所です。  
> 新しい共通ルールファイルを追加したときは、ここに追記します。

このプロジェクトでは、以下の共通ルールを参照します：

- **AI開発の共通方針**: `../common/GLOBAL_AGENT.md`
- **バックエンド共通ルール**: `../common/rules_backend.md`（存在する場合）
- **フロントエンド共通ルール**: `../common/rules_frontend.md`（存在する場合）

---

## 6. プロジェクト固有の詳細ルール

> ガイド: ドメイン知識（「このログの意味」「このタグの扱い」など）は、基本的に `rules_domain.md` に書きます。  
> ここでは「どんな情報が rules_domain.md にあるか」を案内するだけにします。

- **ドメイン固有ルール**: `rules_domain.md` を参照
  - Chrome DevTools MCP 使用ガイド
  - ログファイル配置ルール（詳細）
  - ログスキーマ（フィールド一覧と意味）
  - 重要なタグ（`audit`, `state_change` など）の定義

---

**最終更新**: 2025-12-11  
**バージョン**: 1.0  
※プロジェクトの運用が変わったときは、このファイルを必ず最新状態に更新してください。
